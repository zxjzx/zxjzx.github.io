(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{291:function(n,t,s){"use strict";s.r(t);var a=s(29),e=Object(a.a)({},(function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"四、vue-ci3打包并部署到服务器，在服务器上-centos7-上配置nginx反向代理访问node后端代码1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、vue-ci3打包并部署到服务器，在服务器上-centos7-上配置nginx反向代理访问node后端代码1"}},[n._v("#")]),n._v(" 四、vue-ci3打包并部署到服务器，在服务器上(CentOS7+)上配置nginx反向代理访问node后端代码1")]),n._v(" "),s("ul",[s("li",[n._v("图片显示有问题的可点击链接查看"),s("a",{attrs:{href:"https://blog.csdn.net/sinat_36146776/article/details/93745694",target:"_blank",rel:"noopener noreferrer"}},[n._v("博客原文"),s("OutboundLink")],1)])]),n._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#安装并配置，找到nginx-conf配置代理文件"}},[n._v("安装并配置，找到nginx.conf配置代理文件")])]),s("li",[s("a",{attrs:{href:"#全部代码-nginx-conf"}},[n._v("全部代码 nginx.conf")])]),s("li",[s("a",{attrs:{href:"#测试"}},[n._v("测试")])])])]),s("p"),n._v(" "),s("p",[n._v("使用vue-cli3打包后的项目，如何在服务器上运行？并成功访问node后端代码\n前端打包后的代码在dist文件夹下，直接丢入服务器即可运行，我此处用的是nginx指定前端代码目录“/jane-code/clock-out/dist;”。\n后端代码用node写，node app.js启动，端口号为4000，\n前端后端代码都在一个服务器上，不需要跨域，但是如何跨端口访问呢？\n我的解决思路是，当路径识别到'/api'时，反向代理访问到4000端口进行后端操作。")]),n._v(" "),s("h2",{attrs:{id:"安装并配置，找到nginx-conf配置代理文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装并配置，找到nginx-conf配置代理文件"}},[n._v("#")]),n._v(" 安装并配置，找到nginx.conf配置代理文件")]),n._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[n._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v(" nginx //安装并自动配置\nnginx -t //查找nginx.conf路径，如下图出现 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("test")]),n._v(" is successful 表示nginx全局配置成功\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" /etc/nginx //切换目录\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("vi")]),n._v(" nginx.conf\n")])])]),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190626153942224.png",alt:"在这里插入图片描述"}})]),n._v(" "),s("ul",[s("li",[n._v("关键代码\n"),s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190626155547643.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2MTQ2Nzc2,size_16,color_FFFFFF,t_70",alt:"关键代码"}})])]),n._v(" "),s("h2",{attrs:{id:"全部代码-nginx-conf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全部代码-nginx-conf"}},[n._v("#")]),n._v(" 全部代码 nginx.conf")]),n._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# For more information on configuration, see:")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#   * Official English Documentation: http://nginx.org/en/docs/")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#   * Official Russian Documentation: http://nginx.org/ru/docs/")]),n._v("\n\nuser nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\nworker_processes auto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\nerror_log /var/log/nginx/error.log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\npid /run/nginx.pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# Load dynamic modules. See /usr/share/nginx/README.dynamic.")]),n._v("\ninclude /usr/share/nginx/modules/*.conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\nevents "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    worker_connections "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\nhttp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    log_format  main  "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v("'"),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$remote_addr")]),n._v(" - "),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$remote_user")]),n._v(" ["),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$time_local")]),n._v('] "'),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$request")]),n._v("\" '")]),n._v("\n                      "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v("'"),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$status")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$body_bytes_sent")]),n._v(' "'),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$http_referer")]),n._v("\" '")]),n._v("\n                      "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v("'\""),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$http_user_agent")]),n._v('" "'),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$http_x_forwarded_for")]),n._v("\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    access_log  /var/log/nginx/access.log  main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    sendfile            on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    tcp_nopush          on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    tcp_nodelay         on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    keepalive_timeout   "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    types_hash_max_size "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("2048")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    include             /etc/nginx/mime.types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    default_type        application/octet-stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# Load modular configuration files from the /etc/nginx/conf.d directory.")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# See http://nginx.org/en/docs/ngx_core_module.html#include")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# for more information.")]),n._v("\n    include /etc/nginx/conf.d/*.conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        listen       "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("8080")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        server_name  "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("127.0")]),n._v(".0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        root         /jane-code/clock-out/dist"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# Load configuration files for the default server block.")]),n._v("\n        include /etc/nginx/default.d/*.conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        location /api/ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                proxy_pass http://localhost:4000/api/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n        location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                try_files "),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$uri")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[n._v("$uri")]),n._v("/ @router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n                index  index.html index.htm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n        location @router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                rewrite ^.*$/index.html last"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n        error_page "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("404")]),n._v(" /404.html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n            location "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" /40x.html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n        error_page "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("500")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("502")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("503")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("504")]),n._v(" /50x.html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n            location "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" /50x.html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n")])])]),s("h2",{attrs:{id:"测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[n._v("#")]),n._v(" 测试")]),n._v(" "),s("blockquote",[s("p",[n._v("成功后，你会发现在浏览器中访问,得到的结果一样")])]),n._v(" "),s("ul",[s("li",[n._v("http://47.244.XXX.XX:4000/api/getDBList")]),n._v(" "),s("li",[n._v("http://47.244.XXX.XX:8080/api/getDBList")])])])}),[],!1,null,null,null);t.default=e.exports}}]);